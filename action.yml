name: 'Lint VBA'
description: 'Lint VBA source code.'
branding:
  icon: "sun"
  color: "red"
inputs:
  path:
    description: 'Path to source files.'
    default: ${{ github.workspace }}
runs:
  using: "composite"
  steps:
    - run: |
        cd ${{ github.workspace }}
        python -m pip install antlr4-tools
        wget https://raw.githubusercontent.com/Beakerboy/VBA_Tokenizer/ANTLR/VbaLint
        chmod +x VbaLint
      shell: bash
    - run: |
        cd ${{ inputs.path }}
        ${{ github.workspace }}/VbaLint
      shell: bash
